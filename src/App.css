/* =========================================================================
    PaperMarty — Kaspa Paper Wallet (Folded Card)
    ========================================================================= */

/* -------------------------------------------------------------------------
    TOKENS
    ------------------------------------------------------------------------- */

@import url("https://fonts.googleapis.com/css2?family=Rubik:wght@700;800&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap");

:root {
  /* Colors */
  --bg: #70c7ba;
  --ink: #e7e7e7;
  --muted: #9aa1a6;
  --danger: #b00020;

  /* High-contrast ink over teal */
  --ink-strong: #0e2a27;
  --ink-muted-strong: #214e4a;

  /* App / masthead */
  --app-pad: 20px;
  --app-mt: 8px;
  --header-pad-x: 48px;
  --header-pad-y: 6px;
  --header-mb: 10px;
  --header-gap: 10px;
  --center-maxw: 64vw;
  --social-gap: 14px;

  /* Typography */
  --title-font: "Lato", system-ui, -apple-system, "Segoe UI", Roboto, Helvetica,
    Arial, sans-serif;
  --title-size: 44px;
  --title-weight: 700;
  --title-by-gap: 6px;
  --byline-size: 12px;
  --byline-icon-size: 55px;

  /* Logos / socials */
  --logo-size: 110px;
  --social-icon: 32px;
  --social-hit: 8px;

  /* 3 column grid */
  --col-min: 320px;
  --col-gap: 24px;

  /* Heights */
  --masthead-approx: 84px;
  --footer-reserve: 120px;
  --cards-extra-h: 40px;
  --step-pad-y: 20px;

  /* STEP 3 preview */
  --preview-gap: 10px;
  --preview-scale: 1.06;

  /* STEP rails */
  --step3-rail-w: 44px;
  --step3-print-w: 60px;
  --step-rail-w: 44px; /* STEP 1 & 2 rail */

  /* Card sheet geometry (print) */
  --CARD_W: 53.98mm;
  --CARD_H: 85.6mm;
  --SHEET_W: calc(var(--CARD_W) * 2);
  --SHEET_H: var(--CARD_H);
  --pad: 3mm;
  --QR_PUBLIC: 40mm;
  --QR_SEED: 42mm;
}

/* Responsive tokens */
@media (max-width: 680px) {
  :root {
    --title-size: 30px;
    --byline-size: 11px;
    --byline-icon-size: 18px;
    --logo-size: 56px;
    --social-icon: 20px;
    --social-hit: 6px;
    --header-pad-y: 4px;
    --header-mb: 8px;
  }
}

/* -------------------------------------------------------------------------
    Base
    ------------------------------------------------------------------------- */
* {
  box-sizing: border-box;
}

html,
body,
#root,
.app {
  height: 100%;
}

html,
body {
  overflow: hidden;
} /* no page scroll (desktop) */

body {
  margin: 0;
  background: var(--bg);
  color: var(--ink-strong);
  font: 14px/1.35 "Lato", system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu,
    Cantarell, "Noto Sans", Arial, sans-serif;
}

.app {
  width: 100%;
  margin: var(--app-mt) 0;
  padding-left: max(var(--app-pad), env(safe-area-inset-left));
  padding-right: max(var(--app-pad), env(safe-area-inset-right));
}

/* Inputs / buttons */
.row {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 16px;
}
label {
  display: block;
  font-size: 12px;
  color: var(--ink-muted-strong);
  margin-bottom: 6px;
}
.muted {
  color: var(--ink-muted-strong);
}
input[type="text"] {
  width: 100%;
  background: #0f1113;
  color: #e7e7e7;
  border: 1px solid #2a2f35;
  border-radius: 10px;
  padding: 10px 12px;
}
input::placeholder {
  color: #cfd6da;
}
button {
  cursor: pointer;
  border: 0;
  border-radius: 12px;
  padding: 12px 16px;
  background: #2a6df4;
  color: #fff;
  font-weight: 700;
}
button.ghost {
  background: #1b1d22;
  color: #e7e7e7;
  border: 1px solid #2a2f35;
}

/* -------------------------------------------------------------------------
    Masthead (inline)
    ------------------------------------------------------------------------- */
.masthead {
  padding: var(--header-pad-y) var(--header-pad-x);
  margin-bottom: var(--header-mb);
}
.masthead__inner {
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: var(--header-gap);
  position: relative;
}
.masthead__left {
  display: flex;
  align-items: center;
}
.masthead__right {
  display: flex;
  justify-content: flex-end;
  gap: var(--social-gap);
}

.site-logo {
  width: var(--logo-size);
  height: var(--logo-size);
  object-fit: contain;
  filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.25));
}

.masthead__center {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
  max-width: var(--center-maxw);
}

.title-line {
  display: inline-flex;
  align-items: baseline;
  gap: var(--title-by-gap);
  white-space: nowrap;
}

.site-title {
  margin: 0;
  font-family: var(--title-font);
  font-size: var(--title-size);
  font-weight: var(--title-weight);
  line-height: 1;
  letter-spacing: 0.01em;
  word-spacing: 0.04em;
  color: var(--ink-strong);
  text-shadow: none;
}
.site-byline {
  margin: 0;
  font-size: var(--byline-size);
  color: var(--ink-muted-strong);
  display: inline-flex;
  align-items: center;
  gap: 8px;
}
.by-icon {
  width: var(--byline-icon-size);
  height: var(--byline-icon-size);
  object-fit: contain;
  filter: drop-shadow(0 0 1px rgba(0, 0, 0, 0.1));
}

/* Socials */
.social-btn {
  --hit: var(--social-hit);
  display: inline-grid;
  place-items: center;
  padding: var(--hit);
  width: calc(var(--social-icon) + var(--hit) * 2);
  height: calc(var(--social-icon) + var(--hit) * 2);
  color: #0e2a27;
  text-decoration: none;
  background: transparent;
  border: 0;
  border-radius: 10px;
  transition: transform 0.12s ease, color 0.12s ease, filter 0.12s ease;
  outline: none;
}
.social-btn:hover {
  transform: translateY(-1px) scale(1.06);
  color: #08302b;
  filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.15));
}
.social-btn:active {
  transform: translateY(0) scale(0.98);
}
.social-btn:focus-visible {
  box-shadow: 0 0 0 2px rgba(8, 48, 43, 0.35);
}
/* ✅ New (fixes the Website <img> icon) */
.social-btn svg,
.social-btn img {
  width: var(--social-icon);
  height: var(--social-icon);
  display: block;
  object-fit: contain;
}
.social-btn svg path {
  fill: currentColor;
}

/* Small detail: prevent vertical shift */
.social-btn {
  line-height: 0;
}

/* Masthead title uses Rubik (without touching step titles) */
.masthead .site-title {
  font-family: "Rubik", system-ui, -apple-system, "Segoe UI", Roboto, Helvetica,
    Arial, sans-serif !important;
  font-weight: 800;
  letter-spacing: 0.02em;
}

/* -------------------------------------------------------------------------
    3-COLUMN LAYOUT
    ------------------------------------------------------------------------- */
.layout3 {
  display: grid;
  grid-template-columns: repeat(3, minmax(var(--col-min), 1fr));
  gap: var(--col-gap);
  align-items: stretch;
  height: calc(
    100vh - var(--masthead-approx) - var(--footer-reserve) +
      var(--cards-extra-h)
  );
}
.col {
  min-width: 0;
  display: flex;
  overflow: hidden;
}

.step-card {
  position: relative;
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
  padding: var(--step-pad-y) 16px;
  border-radius: 18px;
  background: rgba(255, 255, 255, 0.35);
  border: 1px solid rgba(8, 48, 43, 0.14);
  box-shadow: 0 8px 26px rgba(0, 0, 0, 0.08);
  backdrop-filter: saturate(130%) blur(6px);
}
.step-head {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}
.step-kicker {
  font-weight: 900;
  letter-spacing: 0.08em;
  font-size: 12px;
  padding: 6px 10px;
  border-radius: 999px;
  color: var(--ink-strong);
  background: rgba(8, 48, 43, 0.08);
  border: 1px solid rgba(8, 48, 43, 0.15);
}
.step-title {
  margin: 0;
  font-family: var(--title-font);
  font-weight: 800;
  font-size: 22px;
  color: var(--ink-strong);
}
.step-actions {
  margin-left: auto;
  display: flex;
  gap: 8px;
}
.step-body {
  flex: 1;
  min-height: 0;
  overflow: auto;
}

/* STEP 3 vertical rail + print button */
.step-card.step3 {
  display: grid;
  grid-template-columns: var(--step3-rail-w) 1fr var(--step3-print-w);
  grid-template-areas: "rail body print";
  gap: 0;
}
.step-card.step3 .step-head {
  grid-area: rail;
  writing-mode: vertical-rl;
  transform: rotate(180deg);
  text-orientation: mixed;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 6px;
  margin: 0;
}
.step-card.step3 .step-kicker {
  font-size: 14px;
  padding: 4px 6px;
}
.step-card.step3 .step-title {
  font-size: 16px;
}
.step-card.step3 .step-body {
  grid-area: body;
  overflow: hidden;
  padding-left: 8px;
  padding-right: 8px;
}
.step-card.step3 .step-side-print {
  grid-area: print;
  display: grid;
  place-items: center;
  padding-left: 6px;
}
.step-card.step3 .step-side-print .ghost {
  padding: 10px 14px;
}

/* -------------------------------------------------------------------------
    STEP 3 PREVIEW (unique scale via --preview-scale)
    ------------------------------------------------------------------------- */
.preview-panel .sheet.card-sheet {
  margin: 0;
}
.preview-stage {
  display: grid;
  gap: var(--preview-gap);
  justify-items: center;
  align-content: start;
}
.preview-sheet {
  height: calc(var(--SHEET_H) * var(--preview-scale));
  display: grid;
  place-items: center;
}
.preview-sheet > .sheet {
  transform: scale(var(--preview-scale));
  transform-origin: top center;
}

/* -------------------------------------------------------------------------
    OPEN SHEET (printable cards)
    ------------------------------------------------------------------------- */
.sheet.card-sheet {
  position: relative;
  width: var(--SHEET_W);
  height: var(--SHEET_H);
  margin: 16px auto;
  background: #fff;
  color: #111;
  border: 1px solid #ddd;
  border-radius: 3mm;
  display: grid;
  grid-template-columns: 1fr 1fr;
  overflow: hidden;
}
@supports (overflow: clip) {
  .sheet.card-sheet {
    overflow: clip;
  }
}
.sheet .half {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}
.sheet .pad {
  width: calc(100% - (var(--pad) * 2));
  height: calc(100% - (var(--pad) * 2));
  padding: var(--pad);
  display: flex;
  flex-direction: column;
  gap: 2mm;
  align-items: center;
  justify-content: center;
}
.sheet .pad > * {
  max-width: 100%;
}

.fold-line {
  position: absolute;
  left: calc(50% - 0.25mm);
  top: 0;
  width: 0.5mm;
  height: 100%;
  background: repeating-linear-gradient(
    to bottom,
    #aaa,
    #aaa 2mm,
    transparent 2mm,
    transparent 4mm
  );
  opacity: 0.7;
  pointer-events: none;
}

.pad-cover {
  justify-content: center;
}
.cover .logo {
  font-weight: 900;
  font-size: 10.5mm;
  letter-spacing: 0.5mm;
  line-height: 1;
  text-align: center;
  color: #111;
}
.cover .logo span {
  color: #2a6df4;
}

.pad-back {
  justify-content: center;
  align-items: center;
  gap: 3mm;
  text-align: center;
}
.qr-public {
  display: block;
  width: var(--QR_PUBLIC);
  aspect-ratio: 1/1;
  height: auto !important;
  background: #fff;
  border: 1px solid #eee;
  border-radius: 2mm;
  image-rendering: crisp-edges;
  image-rendering: pixelated;
}
.addrBlock .addr {
  display: block;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: 2.6mm;
  word-break: break-all;
}

/* Inside (seed) */
.label {
  font-size: 2.6mm;
  color: #555;
  text-transform: uppercase;
  letter-spacing: 0.3mm;
}
.label.danger {
  color: var(--danger);
  font-weight: 800;
}

.info {
  width: 100%;
}

.mono {
  display: block;
  white-space: normal;
  word-break: break-word;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: 2.3mm;
  line-height: 1.25;
  background: #f7f7f7;
  padding: 1.2mm;
  border-radius: 2mm;
  border: 1px solid #eee;
}
.no-scroll {
  max-height: none !important;
  overflow: visible !important;
}

.pad-secret {
  justify-content: flex-start;
  align-items: stretch;
  gap: 2mm;
  padding-top: 2mm;
}

.qr-seed {
  display: block;
  width: var(--QR_SEED);
  aspect-ratio: 1/1;
  height: auto !important;
  border: 1px solid #eee;
  border-radius: 2mm;
  background: #fff;
  image-rendering: crisp-edges;
  image-rendering: pixelated;
}

/* -------------------------------------------------------------------------
    ENTROPY OVERLAY
    ------------------------------------------------------------------------- */
.entropy-overlay {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}
.entropy-card {
  width: 96vw;
  height: 86vh;
  max-height: 860px;
  background: #111418;
  color: #e7e7e7;
  border: 1px solid #27303a;
  border-radius: 14px;
  padding: 16px 18px;
  box-shadow: 0 18px 50px rgba(0, 0, 0, 0.45);
  display: grid;
  gap: 12px;
  grid-template-rows: auto auto 1fr auto auto auto;
}
.entropy-pad {
  position: relative;
  min-height: 52vh;
  border: 2px dashed #3a4350;
  border-radius: 12px;
  background: #0f1113;
  margin: 8px 0 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  user-select: none;
  cursor: crosshair;
}
.entropy-canvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
}
.entropy-instr {
  position: relative;
  z-index: 2;
  color: #9fb1c4;
  font-size: 16px;
  pointer-events: none;
}

/* Progress bar */
.pm-prog {
  margin-top: 4px;
}
.pm-prog__track {
  position: relative;
  width: 100%;
  height: 22px;
  border-radius: 999px;
  overflow: hidden;
  background: #1d232a;
  border: 1px solid #2c3440;
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.04);
}
.pm-prog__fill {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 0%;
  background: linear-gradient(90deg, #2a6df4, #22d8a2);
  box-shadow: 0 0 12px rgba(48, 165, 255, 0.45);
  transition: width 120ms linear;
}
.progress-meta {
  margin-top: 4px;
  display: flex;
  justify-content: space-between;
  color: #9aa1a6;
  font-size: 13px;
}
.entropy-actions {
  margin-top: 6px;
  display: flex;
  gap: 10px;
  justify-content: flex-end;
}

/* -------------------------------------------------------------------------
    PRINT (A4 duplex short-edge flip)
    ------------------------------------------------------------------------- */
@media print {
  @page {
    size: A4;
    margin: 10mm;
  }

  html,
  body {
    background: #fff;
    color: #111;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  .noprint,
  .entropy-overlay,
  .step-side-print {
    display: none !important;
  }

  .sheet.card-sheet {
    margin: 0 auto;
    width: var(--SHEET_W) !important;
    height: var(--SHEET_H) !important;
    page-break-inside: avoid;
    overflow: hidden;
  }
  .sheet.card-sheet + .sheet.card-sheet {
    page-break-before: always;
  }

  .pad-secret {
    padding-top: 1.5mm;
  }
  .cover .logo {
    font-size: 10mm;
  }
  .label,
  .addrBlock .addr,
  .mono {
    font-size: 2.3mm;
  }
  .qr-public {
    width: 38mm;
    aspect-ratio: 1/1;
    height: auto !important;
  }
  .qr-seed {
    width: min(40mm, var(--QR_SEED));
    aspect-ratio: 1/1;
    height: auto !important;
  }
}

/* -------------------------------------------------------------------------
    STEP 1 & STEP 2 — vertical rail (same direction as STEP 3)
    ------------------------------------------------------------------------- */
.step-card.step1,
.step-card.step2 {
  display: grid;
  grid-template-columns: var(--step-rail-w) 1fr;
  grid-template-areas: "rail body";
  gap: 0;
  align-items: stretch;
}
.step-card.step1 .step-head,
.step-card.step2 .step-head {
  grid-area: rail;
  writing-mode: vertical-rl; /* bottom → top, legible letters */
  transform: rotate(180deg);
  text-orientation: mixed;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 6px;
  margin: 0;
}
.step-card.step1 .step-body,
.step-card.step2 .step-body {
  grid-area: body;
  overflow: hidden;
  padding: 0 8px;
}
.step-card.step1 .step-kicker,
.step-card.step2 .step-kicker {
  font-size: 14px;
  padding: 4px 6px;
}
.step-card.step1 .step-title,
.step-card.step2 .step-title {
  font-size: 16px;
}

/* -------------------------------------------------------------------------
    Entropy Cursor (halo)
    ------------------------------------------------------------------------- */
.entropy-cursor {
  position: fixed;
  left: var(--x, -100px);
  top: var(--y, -100px);
  width: 22px;
  height: 22px;
  border-radius: 50%;
  pointer-events: none;
  opacity: 0;
  z-index: 9999;
  border: 2px solid rgba(34, 216, 162, 0.9);
  box-shadow: 0 0 14px rgba(34, 216, 162, 0.6),
    0 0 30px rgba(42, 109, 244, 0.35);
  transform: translate(-50%, -50%);
  transition: opacity 120ms ease;
  mix-blend-mode: screen;
}
.entropy-cursor.on {
  opacity: 0.95;
  animation: entropyPulse 900ms ease-in-out infinite alternate;
}
.entropy-cursor.on::after {
  content: "";
  position: absolute;
  inset: -6px;
  border: 2px dashed rgba(34, 216, 162, 0.55);
  border-radius: 50%;
  animation: entropySpin 1.6s linear infinite;
  pointer-events: none;
}
@keyframes entropyPulse {
  from {
    transform: translate(-50%, -50%) scale(0.9);
  }
  to {
    transform: translate(-50%, -50%) scale(1.08);
  }
}
@keyframes entropySpin {
  to {
    transform: rotate(360deg);
  }
}

/* -------------------------------------------------------------------------
    Donate: gentle zoom loop (accessibility-friendly)
    ------------------------------------------------------------------------- */
@keyframes donate-pulse {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.15);
  }
  100% {
    transform: scale(1);
  }
}
.donate-title {
  display: inline-block;
  transform-origin: center;
  animation: donate-pulse 1.2s ease-in-out infinite;
  will-change: transform;
}
@media (prefers-reduced-motion: reduce) {
  .donate-title {
    animation: none;
  }
}

/* -------------------------------------------------------------------------
    MOBILE (≤ 900px) — scroll OK + stack of 3 steps + clean masthead
    ------------------------------------------------------------------------- */
@media (max-width: 900px) {
  /* Unlock main scroll (single scrollbar) */
  html,
  body {
    height: auto !important;
    min-height: 100vh !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior-y: contain;
  }
  #root,
  .app {
    height: auto !important;
    min-height: 100%;
  }

  /* 3 columns -> 1 column */
  .layout3 {
    grid-template-columns: 1fr;
    height: auto !important;
    gap: 16px;
  }

  /* No sub-scroll in cards */
  .col,
  .step-card .step-body {
    overflow: visible !important;
  }

  /* STEP 3 : Print button below the preview */
  .step-card.step3 {
    grid-template-columns: var(--step3-rail-w) 1fr;
    grid-template-areas:
      "rail body"
      "print print";
  }
  .step-card.step3 .step-side-print {
    padding: 8px 0 0;
    place-items: center;
  }

  /* Compact masthead, no overlap */
  .masthead {
    padding: 8px 16px;
  }
  .masthead__inner {
    display: grid;
    grid-template-columns: 1fr auto;
    grid-template-rows: auto auto;
    grid-template-areas:
      "logo socials"
      "title title";
    gap: 8px;
  }
  .masthead__left {
    grid-area: logo;
  }
  .masthead__right {
    grid-area: socials;
    justify-content: end;
  }
  .masthead__center {
    grid-area: title;
    position: static !important;
    transform: none !important;
    max-width: 100%;
    text-align: center;
  }
  .title-line {
    white-space: normal;
    flex-wrap: wrap;
    justify-content: center;
  }

  /* Reduced sizes on mobile */
  .site-logo {
    width: 56px;
    height: 56px;
  }
  .site-title {
    font-size: clamp(22px, 6.2vw, var(--title-size));
  }
  .site-byline {
    font-size: 12px;
  }
  .by-icon {
    width: 18px;
    height: 18px;
  }
  .social-btn {
    --social-hit: 6px;
  }
  .social-btn svg {
    width: 20px;
    height: 20px;
  }
}
